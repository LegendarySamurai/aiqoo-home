"use strict";function setEndSession(n,t,i){if(i<=t){var r=createRequestObject();r.open("GET",n);r.send();r.onreadystatechange=function(){var f=this,u;r.readyState===4&&(r.status==200||(u=setTimeout(function(){setEndSession(n,t,i+1)},2e3)))}}}function startTrack(){_ut_Parent_GUID=getCookie("Cookie_Parent_Guide")+"";_ut_Parent_GUID.length<30&&(_ut_Parent_GUID="0");_ut_ip_api=getCookie("Cookie_Ip_Api");_ut_ip_api.length<5?getIpApiRequest("https://api.ipdata.co/?api-key=565e4d0e5329609464a995a1d828b97341e2867b20e97fefc676d863",3,1):populateUserObject();setUtmParam("utm_source");setUtmParam("utm_medium");setUtmParam("utm_campaign");setUtmParam("utm_term");setUtmParam("utm_content");setUtmParam("utm_keyword");setUtmParam("utm_tags")}function setUtmParam(n){if(getUrlParams(n,window.location.href)!==null){var t=getUrlParams(n,window.location.href)+"";t.length>1&&setCookie(n,t,168)}}function populateUserObject(){var u,r;_userObj={};_userObj.browser_language=navigator.language;_userObj.brwoser_name=checkBrowser();_userObj.browser_version=checkVersionBrowser();_userObj.platform=navigator.platform;_userObj.operation_system=navigator.appVersion;_userObj.connection=GetConnection();_userObj.connection_speed=ConnectionSpeed();_userObj.url=window.location.href;_userObj.page_refer=document.referrer;_userObj.device_operation_system=getDeviceOperatingSystem();_userObj.device=getDevice();_userObj.device_height=screen.height;_userObj.device_width=screen.width;_userObj.document_height=window.innerHeight;_userObj.document_width=window.innerWidth;_userObj.page_open_time=new Date;_userObj.utm_source=getUrlParams("utm_source");_userObj.utm_medium=getUrlParams("utm_medium");_userObj.utm_campaign=getUrlParams("utm_campaign");_userObj.utm_term=getUrlParams("utm_term");_userObj.utm_content=getUrlParams("utm_content");_userObj.utm_keyword=getUrlParams("utm_keyword");_userObj.utm_tags=getUrlParams("utm_tags");try{navigator.getBattery().then(function(n){return u=n.level*100+"%"}).then(function(n){_userObj.battery_status=n})}catch(f){_userObj.battery_status="-1%"}var n=JSON.parse(JSON.parse(_ut_ip_api)),t="",i="";for(r=0;r<n.languages.length;r++)t+=n.languages[r].name+",",i+=n.languages[r].rtl+",";t+="###";i+="###";t=t.replace(",###","");i=i.replace(",###","");_userObj.ip=n.ip;_userObj.is_eu=n.is_eu;_userObj.city=n.city;_userObj.region=n.region;_userObj.region_code=n.region_code;_userObj.country_name=n.country_name;_userObj.country_code=n.country_code;_userObj.continent_name=n.continent_name;_userObj.continent_code=n.continent_code;_userObj.latitude=n.latitude;_userObj.longitude=n.longitude;_userObj.asn=n.asn;_userObj.organisation=n.organisation;_userObj.postal=n.postal;_userObj.calling_code=n.calling_code;_userObj.flag=n.flag;_userObj.languages_name=t;_userObj.languages_rtl=i;_userObj.currency_name=n.currency.name;_userObj.currency_code=n.currency.code;_userObj.currency_symbol=n.currency.symbol;_userObj.currency_native=n.currency["native"];_userObj.currency_plural=n.currency.plural;_userObj.time_zone_name=n.time_zone.name;_userObj.time_zone_abbr=n.time_zone.abbr;_userObj.time_zone_offset=n.time_zone.offset;_userObj.time_zone_is_dst=n.time_zone.is_dst;_userObj.time_zone_current_time=n.time_zone.current_time;_userObj.threat_is_tor=n.threat.is_tor;_userObj.threat_is_proxy=n.threat.is_proxy;_userObj.threat_is_anonymous=n.threat.is_anonymous;_userObj.threat_is_known_attacker=n.threat.is_known_attacker;_userObj.threat_is_known_abuser=n.threat.is_known_abuser;_userObj.threat_is_threat=n.threat.is_threat;_userObj.threat_is_bogon=n.threat.is_bogon;SendUtPointToServer()}function SendUtPointToServer(){var n={};n.WebID=_ut_web_id.replace("Aiq-","");n.parentGuide=_ut_Parent_GUID;n.FullData=JSON.stringify(_userObj);postRequest("POST",_apiUrl,"TrackingPoints/ut_addPoint",3,1,JSON.stringify(n))}function getIpApiRequest(n,t,i){if(i<=t){var r=createRequestObject();r.open("GET",n);r.send();r.onreadystatechange=function(){var o=this,u,f,e;if(r.readyState===4){if(r.status==200)return _ut_ip_api=r.responseText,u=_ut_ip_api.indexOf("emoji_flag"),f=_ut_ip_api.indexOf("languages"),_ut_ip_api=JSON.stringify(_ut_ip_api.replace(_ut_ip_api.substring(u,f),"")),setCookie("Cookie_Ip_Api",_ut_ip_api,1),populateUserObject(),r.responseText;e=setTimeout(function(){makeGetRequest(n,t,i+1)},2e3)}}}else _ut_ip_api="{}",populateUserObject()}function postRequest(n,t,i,r,u,f){if(u<=r){var e=createRequestObject();t+=i;e.open(n,t,!0);e.setRequestHeader("Content-Type","application/json");e.setRequestHeader("Access-Control-Allow-Origin","*");e.send(f);e.onreadystatechange=function(){var n,t;e.readyState==4&&(e.status==200?(n=JSON.parse(JSON.parse(JSON.stringify(e.responseText))),n.error==!1?(setCookie("Cookie_GUID",n.responseMessage,1),_ut_GUID=n.responseMessage,_ut_Parent_GUID=="0"&&(setCookie("Cookie_Parent_Guide",n.responseMessage,8760),_ut_Parent_GUID=n.responseMessage)):t=setTimeout(function(){postRequest(i,r,u+1,f)},2e3)):t=setTimeout(function(){postRequest(i,r,u+1,f)},2e3))}}}function createRequestObject(){var n;if(window.XMLHttpRequest)try{n=new XMLHttpRequest}catch(t){n=!1}else if(window.ActiveXObject)try{n=new ActiveXObject("Msxml2.HTMLHTTP")}catch(t){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){n=!1}}return n}function getUrlParams(n,t){t||(t=window.location.href);n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function getCookie(n){for(var t,r=n+"=",f=decodeURIComponent(document.cookie),u=f.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function setCookie(n,t,i){var r=new Date,u;r.setTime(r.getTime()+i*36e5);u="expires="+r.toUTCString();document.cookie=n+"="+t+";"+u+";path=/"}function getBattery(){try{var n=!1;return navigator.getBattery().then(function(t){n=t.charging;t.addEventListener("chargingchange",function(){n=t.charging})}),n}catch(t){return"Not Support"}}function getDeviceOperatingSystem(){var n=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(n)?"Windows Phone":/android/i.test(n)?"Android":/iPad|iPhone|iPod/.test(n)&&!window.MSStream?"iOS":/Chrome/.test(n)?"Chrome":"unknown"}function getDevice(){var n=navigator.userAgent||navigator.vendor||window.opera;return/iPhone/.test(n)?"Iphone":/Nokia/.test(n)?"Nokia":/Nexus/.test(n)?"Nexus":/iPad/.test(n)?"Ipad":/Android/.test(n)?"Android":/Windows Phone/.test(n)?"Windows Phone":/Windows/.test(n)?"Windows PC":void 0}function checkBrowser(){var n=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=typeof InstallTrigger!="undefined",i=/constructor/i.test(window.HTMLElement)||function(n){return n.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari!="undefined"&&safari.pushNotification),r=/*@cc_on!@*/!1||!!document.documentMode,u=!r&&!!window.StyleMedia,f=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);return n?"Opera":t?"Firefox":i?"Safari":u?"Edge":f?"Chrome":void 0}function GetConnection(){try{return navigator.connection.effectiveType}catch(n){return n="Not Support"}}function ConnectionSpeed(){try{return/\slow-2g|2g|3g/.test(navigator.connection.effectiveType)?"slow":"fast"}catch(n){return"Not Support"}}function checkVersionBrowser(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],"IE "+(t[1]||"")):n[1]==="Chrome"&&(t=i.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),n.join(" "))}var _ut_web_id="Aiq-3",_apiUrl="https://api.aiq-magazine.com/api/v1/",_ut_GUID,_ut_Parent_GUID,_ut_ip_api,_userObj,myExtObject;console.log("ut ver 0.3");startTrack();myExtObject={fireConvEvent:function(n){window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"conv_"+n.toLowerCase()})},getVariableVal:function(n){return eval(n)},zipChange:function(n){mapPanToByZip(n)}};window.addEventListener("beforeunload",function(){setEndSession(_apiUrl+"TrackingPoints/ut_setEndSession?gUid="+_ut_GUID,3,1)});